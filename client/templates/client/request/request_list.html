{% extends 'client/client.html' %}
{% load static %}

{% block main %}
<style>
    .progress-bar {
        width: 500px;
        margin: 0 auto;
    }

    .progress-meter {
        padding: 0;
    }

    ol.progress-meter {
        padding-bottom: 9.5px;
        list-style-type: none;
        display: flex; 
        justify-content: space-between;
    }

    ol.progress-meter li {
        display: inline-block;
        text-align: center;
        text-indent: -19px;
        height: 36px;
        width: 98px;
        font-size: 12px;
        border-bottom-width: 5px;
        border-bottom-style: solid;
        border-radius: 5px;
    }

    ol.progress-meter li:before {
        position: relative;
        float: left;
        text-indent: 0;
        left: -webkit-calc(50% - 9.5px);
        left: -moz-calc(50% - 9.5px);
        left: -ms-calc(50% - 9.5px);
        left: -o-calc(50% - 9.5px);
        left: calc(50% - 9.5px);
    }

    ol.progress-meter li.finished {
        font-size: 12px;
    }

    ol.progress-meter li.finished:before {
        content: "\2713";
        height: 19px;
        width: 19px;
        line-height: 19px;
        bottom: -28.175px;
        border: none;
        border-radius: 19px;
    }
    
    ol.progress-meter li.finished {
        color: black;
        border-bottom-color: yellowgreen;
    }

    ol.progress-meter li.finished:before {
        color: white;
        background-color: yellowgreen;
    }

    ol.progress-meter li.working {
        font-size: 12px;
    }

    ol.progress-meter li.working:before {
        content: "\2B24";
        font-size: 17.1px;
        bottom: -26.95px;
        line-height: 18.05px;
    }

    ol.progress-meter li.working {
        color: blue;
        border-bottom-color: blue;
    }

    ol.progress-meter li.working:before {
        color: blue;
    }
    ol.progress-meter li.pending {
        font-size: 12px;
    }

    ol.progress-meter li.pending:before {
        content: "\2B24";
        font-size: 17.1px;
        bottom: -26.95px;
        line-height: 18.05px;
    }

    ol.progress-meter li.pending {
        color: silver;
        border-bottom-color: silver;
    }

    ol.progress-meter li.pending:before {
        color: silver;
    }
</style>
<div class="Container">
    <h1>List Of Pending Analysis Requests</h1>


    {% for appointment in appointments %}
    <h3>{{appointment}}</h3>
        {% if appointment.status != Appointment.OVERDUE %}
            <div class="progress-bar">
                <ol class="progress-meter">
                    <li class="progress-point {% if appointment.performed %}finished{% else %}working{% endif %}">Booked</li>
                    
                    {% if appointment.analysisrequest and appointment.performed %}

                        {% if appointment.analysisrequest.status == 'pending' %}
                            <li class="progress-point working">Pending</li>
                            <li class="progress-point pending">Working-on</li>
                        {% endif %}
                            
                        {% if appointment.analysisrequest.status == "working-on" %}
                            <li class="progress-point finished">Pending</li>
                            <li class="progress-point working">Working-on</li>
                        {% endif %}

                        {% if appointment.analysisrequest.status == "finished" %}
                            <li class="progress-point finished">Pending</li>
                            <li class="progress-point finished">Working-on</li>
                        {% endif %}
                            
                        
                        {% if appointment.analysisrequest.testresult %}
                        
                            {% if appointment.analysisrequest.testresult.approved %}
                                <li class="progress-point finished">Approved</li>
                            {% else %}
                                <li class="progress-point working">Unapproved</li>
                                <li class="progress-point pending">Unfinished</li>
                            {% endif %}
                                
                            {% if appointment.analysisrequest.testresult.report.invoice %}
                                <li class="progress-point finished">Finished</li>
                            {% elif appointment.analysisrequest.testresult.approved %}
                                <li class="progress-point working">Finished</li>
                            {% endif %}

                        {% else %}
                            <li class="progress-point pending">Unapproved</li>
                            <li class="progress-point pending">Finished</li>
                        {% endif %}

                    {% else %}
                        <li class="progress-point pending">Pending</li>
                        <li class="progress-point pending">Working-on</li>
                        <li class="progress-point pending">Unapproved</li>
                        <li class="progress-point pending">Finished</li>
                    {% endif %}
                    
                </ol>
            </div>
        {% endif %}
    {% endfor %}


</div>
{% endblock main %}